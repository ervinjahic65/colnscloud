(window["3eiXJRXgVuLsYGH9303q"]=window["3eiXJRXgVuLsYGH9303q"]||[]).push([[2],{383:function(e,t,n){"use strict";n.r(t),n.d(t,"Conductor",function(){return oe}),n.d(t,"WIDGET_POSITIONING",function(){return re});var i=n(0),c=n.n(i),d=n(1),u=Object.defineProperty,s=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable,v=function k(e,t,n){return t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},p=function I(e,t){for(var n in t||(t={}))f.call(t,n)&&v(e,n,t[n]);if(s){var r=!0,o=!1,i=void 0;try{for(var a,c=s(t)[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){n=a.value;w.call(t,n)&&v(e,n,t[n])}}catch(d){o=!0,i=d}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}}return e},m={conductor:"C",widget:"W"},h=function R(){switch(window.DRIFT_ENV){case"qa":return"qa";case"prod":return"prod";default:return window.location.hostname.includes("localhost")?"local":"qa"}},y={info:function info(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];window.driftEnableLog&&(e=console).info.apply(e,["SCBroadcast[".concat(t,"]:: ")].concat(r))},error:function error(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];window.driftEnableLog&&(e=console).error.apply(e,["SCBroadcast[".concat(t,"]:: ")].concat(r))}},x=function b(e){return function ne(){return new URLSearchParams(window.location.search)}().get(e)};function T(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}var b=function B(e,t){function r(n,r,o){if(!(typeof document>"u")){"number"==typeof(o=T({},t,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),n=encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var a in o)o[a]&&(i+="; "+a,!0!==o[a]&&(i+="="+o[a].split(";")[0]));return document.cookie=n+"="+e.write(r,n)+i}}return Object.create({set:r,get:function o(t){if(!(typeof document>"u"||arguments.length&&!t)){for(var n=document.cookie?document.cookie.split("; "):[],r={},o=0;o<n.length;o++){var i=n[o].split("="),a=i.slice(1).join("=");try{var c=decodeURIComponent(i[0]);if(r[c]=e.read(a,c),t===c)break}catch(d){}}return t?r[t]:r}},remove:function remove(e,t){r(e,"",T({},t,{expires:-1}))},withAttributes:function withAttributes(e){return B(this.converter,T({},this.attributes,e))},withConverter:function withConverter(e){return B(T({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}({read:function read(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function write(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),E=function N(){var e=new Date;return new Date(e.setFullYear(e.getFullYear()+2))},C=function H(e){var t=b.get(e);if(t)return t;var n=function $(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}();return b.set(e,n,{expires:E()}),n},L=function D(e){return b.get(e)},S=function _(){switch(window.DRIFT_ENV){case"qa":return"qa";case"prod":return"prod";default:return window.location.hostname.includes("localhost")?"local":"qa"}},_=function j(e){var t,n=e.x,r=e.y,o=e.event,i=void 0===o?"mouse":o,a=N();if(a){var c=a.getBoundingClientRect(),d=n-c.x,l=r-c.y;d>0&&l>0&&(null==(t=a.contentWindow)||t.postMessage({action:"toggleDeadSpace",x:d,y:l,eventType:i},"*"))}},R={id:"site-concierge-iframe",className:"site-concierge",src:{local:"http://localhost:4000",qa:"https://site-concierge.drifttqa.com",prod:"https://site-concierge.driftt.com"},dimensions:{desktop:{defaultWidth:"100%",defaultHeight:"100%"},mobile:{defaultWidth:"100%",defaultHeight:"100%"}}},U=function q(e){var t,n=e.embedId,r=e.parentPageUrl,o=e.parentPageQueryParams,i=document.createElement("iframe");i.id=R.id,i.className=R.className,i.width="0px",i.height="0px",i.style.position="fixed",i.style.bottom="0px",i.style.right="0px",i.style.zIndex="2147483646",i.style.overflow="hidden",i.style.border="none";var a=C("driftt_aid"),c=o.get("leadId"),d=o.get("SC_PREVIEW_CODE"),l=function W(e){return b.get(e)}("sc_preview_jwt");o.delete("leadId"),o.delete("embedId");var u=c||a,s=L("drift_eid"),f=L("drift_ujwt");i.referrerPolicy="same-origin";var w=null!=(t=window.DRIFT_ENV)?t:"qa",v="".concat(R.src[S()],"\n?embedId=").concat(encodeURIComponent(n),"\n&parentPageUrl=").concat(encodeURIComponent(r),"\n&driftEnv=").concat(w,"\n&conductor=cohab\n&parentPageQueryParams=").concat(encodeURIComponent(o.toString()),"\n").concat(u?"&leadId=".concat(encodeURIComponent(u)):"","\n").concat(s?"&externalId=".concat(encodeURIComponent(s)):"","\n").concat(f?"&endUserJwt=".concat(encodeURIComponent(f)):"","\n").concat(d?"&SC_PREVIEW_CODE=".concat(encodeURIComponent(d)):"").concat(l?"&SC_PREVIEW_JWT=".concat(encodeURIComponent(l)):"");return i.src=v,document.body.appendChild(i),i.style.pointerEvents="none",function M(){window.addEventListener("touchstart",function(e){var t,n,r,o,i,a;if(!window.driftV2.hasSelfDestructed){var c=null!=(r=null==(n=null==(t=e.changedTouches)?void 0:t[0])?void 0:n.clientX)?r:0,d=null!=(a=null==(i=null==(o=e.changedTouches)?void 0:o[0])?void 0:i.clientY)?a:0;_({x:c,y:d,event:"touch"})}}),window.addEventListener("mousemove",function(e){var t,n;if(!window.driftV2.hasSelfDestructed){var r=null!=(t=null==e?void 0:e.clientX)?t:0,o=null!=(n=null==e?void 0:e.clientY)?n:0;_({x:r,y:o})}}),window.addEventListener("message",function(e){if(!window.driftV2.hasSelfDestructed&&"simulateClick"===e.data.action){var t=N();if(!t)return;t.style.pointerEvents="none",setTimeout(function(){var e,t=null==(e=document.activeElement)?void 0:e.closest("button, input, select, textarea, a");t&&t.click()})}})}(),i},N=function g(){if(!window.driftV2.hasSelfDestructed){var e=document.getElementById(R.id);if(!e)throw new Error("Could not find site concierge iframe element");return e}},Y=function P(e){var t=e.width,n=e.height,r=N();r&&(t&&(r.width=t.toString()),n&&(r.height=n.toString()))},z=function A(e){var t=e.target,n=e.clientName;return new Proxy({},{get:function get(e,r){var o;window.driftEnableLog="prod"!==h()||"true"===(null==(o=x("driftEnableLog"))?void 0:o.toLowerCase());var i="widget"===n?"conductor":"widget",a=t();return function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return new Promise(function(e,o){y.info(m[n]," \u2b06\ufe0fOutbound ".concat(String(r)),null!=t[0]?t[0]:"(no payload)");var c=setTimeout(function(){var e;null!=(e=window.driftV2)&&e.hasSelfDestructed||(y.error(m[n],"\ud83d\udd34Error    ".concat(String(r)," timeout")),window.removeEventListener("message",d),o(new Error("".concat(String(r)," timeout"))))},2e3),d=function l(t){var o=t.data,a=o.source,d=o.action,u=o.payload;d==="".concat(String(r),"-response")&&a===i&&(y.info(m[n],"\ud83d\udfe2Success  ".concat(String(r)," => ").concat(u)),window.removeEventListener("message",l),clearTimeout(c),e(u))};window.addEventListener("message",d),null==a||a.postMessage({action:r,payload:t[0],source:n},"*")})}}})}({clientName:"conductor",target:function target(){var e;return null==(e=N())?void 0:e.contentWindow}}),J=p({},{navigateToPage:function navigateToPage(e){var t=e.path;return z.navigateToPage({path:t})},getLocale:function getLocale(){return z.getCurrentLocale()},renderConversationPreview:function renderConversationPreview(e){var t=e.message;return z.renderPreview({data:t,preview:"chat",initiatedBy:"widgetV2"})},displayLegacyChatIcon:function displayLegacyChatIcon(e){var t=e.shouldDisplay;return z.displayLegacyChatIcon(t)},totalUnreadMessagesCount:function totalUnreadMessagesCount(e){var t=e.totalUnreadMessages;return z.totalUnreadMessagesCount(t)},hide:function hide(){Y({height:"0",width:"0"})}}),G={openChat:function openChat(){window.drift.api.hidePreview(),setTimeout(function(){window.drift.config(re.CHAT),window.drift.openChat()},500)},closeChat:function closeChat(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";window.drift.api.app({name:"site-concierge",event:"open",initiatedBy:t})},closePreview:function closePreview(){window.drift.api.hidePreview()},unregister:function unregister(){window.drift.api.app({event:"unregister",name:"site-concierge"});var e=document.getElementById("drift-frame-controller"),t=document.getElementById("drift-frame-chat");window.drift.config(re.DEFAULT),e&&e.classList.remove("drift-frame-controller__sc-loaded"),t&&t.classList.remove("drift-frame-chat__sc-loaded")}},$={info:function info(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];window.driftEnableLog&&(e=console).info.apply(e,["SCConductor:: "].concat(n))},error:function error(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];window.driftEnableLog&&(e=console).error.apply(e,["SCConductor:: "].concat(n))}};function X(e,t){return _X.apply(this,arguments)}function _X(){return(_X=Object(d.a)(c.a.mark(function _callee3(e,t){var n,r,o,i,a=arguments;return c.a.wrap(function _callee3$(l){for(;;)switch(l.prev=l.next){case 0:if(n=a.length>2&&void 0!==a[2]?a[2]:1e3,i=function(){var r=Object(d.a)(c.a.mark(function _callee2(){return c.a.wrap(function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:if(!(t>0)){r.next=4;break}return r.next=3,new Promise(function(e){return setTimeout(e,n)});case 3:return r.abrupt("return",X(e,t-1,n));case 4:$.error("Failed to leave cohabitation after multiple attempts");case 5:case"end":return r.stop()}},_callee2)}));return function o(){return r.apply(this,arguments)}}(),l.t0=void 0===(null==(r=window.drift)?void 0:r.isCohabiting),!l.t0){l.next=6;break}return l.next=6,i();case 6:if(null==(o=window.drift)||!o.isCohabiting){l.next=17;break}return l.prev=7,l.abrupt("return",e());case 11:return l.prev=11,l.t1=l.catch(7),l.next=15,i();case 15:l.next=6;break;case 17:case"end":return l.stop()}},_callee3,null,[[7,11]])}))).apply(this,arguments)}var Q={saveJWTToParent:function saveJWTToParent(e,t){!function V(e,t){b.set(e,t,{expires:E()})}("sc_preview_jwt",t.jwt)}};var K={attachHookScrollListener:function attachHookScrollListener(e,t){var n=null!=t?t:{},r=n.scrollThreshold,o=void 0===r?.4:r,i=n.previewType,a=function Z(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250;return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];clearTimeout(t),t=setTimeout(function(){return e.apply(void 0,o)},n)}}(Object(d.a)(c.a.mark(function _callee(){var e,t,n;return c.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:if(!window.driftV2.hasSelfDestructed){r.next=2;break}return r.abrupt("return");case 2:if(e=window.innerHeight||document.documentElement.clientHeight,t=document.body.scrollHeight,!(window.scrollY>=o*(t-e))){r.next=9;break}return r.next=6,z.renderPreview({preview:i,initiatedBy:"scroll"});case 6:n=r.sent,n.success&&window.removeEventListener("scroll",a);case 9:case"end":return r.stop()}},_callee)})));window.addEventListener("scroll",a)}},ee=function F(e){var t=e.router,n=e.serverName,r=e.ctx,o=Object.keys(t),i=o.filter(function(e){return o.indexOf(e)!==o.lastIndexOf(e)});if(i.length>0)throw new Error("Duplicate routeHandlers found: ".concat(i.join(", ")));return{start:function start(){var e,o;window.driftEnableLog="prod"!==h()||"true"===(null==(e=x("driftEnableLog"))?void 0:e.toLowerCase());var i="widget"===n?parent:null==(o=document.getElementById("site-concierge-iframe"))?void 0:o.contentWindow;if(null==i||null==window)throw new Error("Broadcast server can only be started in the browser");y.info(m[n],"Started");var c=function a(e){if(e.data.action){var o=e.data,c=o.action,d=o.payload,l=t[c];if(l){var u;"toggleDeadSpacePassthrough"!==c&&y.info(m[n]," \u2b07\ufe0fInbound  ".concat(String(c)),null!=d?d:"(no payload)");try{switch(!0){case null==r:u=l({},d);break;case"function"==typeof r:u=l(r(),d);break;default:u=l(r,d)}}catch(s){return void y.error(m[n],"\ud83d\udd34Error    ".concat(String(c)),s)}i.postMessage({action:"".concat(String(c),"-response"),payload:u,source:n},"*")}}};return window.addEventListener("message",c),{stop:function stop(){window.removeEventListener("message",c)}}}}}({serverName:"conductor",router:p(p(p(p({},{toggleDeadSpacePassthrough:function toggleDeadSpacePassthrough(e,t){var n=t.isEnabled,r=N();r&&(r.style.pointerEvents=n?"none":"auto")},updateFrameDimensions:function updateFrameDimensions(e,t){var n=t.width,r=t.height;Y({width:n,height:r})},killIFrame:function killIFrame(){var e;try{null==(e=N())||e.remove(),window.driftV2.hasSelfDestructed=!0,X(function(){window.drift.api.app({event:"unregister",name:"site-concierge",handler:function handler(){var e=document.getElementById("drift-frame-controller"),t=document.getElementById("drift-frame-chat");window.drift.config(re.DEFAULT),e&&e.classList.remove("drift-frame-controller__sc-loaded"),t&&t.classList.remove("drift-frame-chat__sc-loaded")}})},5)}catch(t){$.error(t)}},overrideParentPageStyles:function overrideParentPageStyles(e,t){var n=t.property,r=t.value;try{var o=window.document.documentElement;o&&(o.style[n]=r)}catch(o){$.error(o)}}}),G),K),Q)}),te=function L(){return new URLSearchParams(window.location.search)},ne=function O(e){return te().get(e)},re={CHAT:{horizontalOffset:72,verticalOffset:-40},DEFAULT:{horizontalOffset:24,verticalOffset:24},SLIDER:{horizontalOffset:0,verticalOffset:0}},oe=function bt(e){var t,n,r=e.embedId;window.driftEnableLog="prod"!==S()||"true"===(null==(t=ne("driftEnableLog"))?void 0:t.toLowerCase()),$.info("Conductor Started"),window.driftV2=J;var o=null!=(n=ne("embedId"))?n:r,i=U({embedId:o,parentPageUrl:window.location.href,parentPageQueryParams:te()});ee.start(),setTimeout(function(){window.drift?window.drift("on","ready",function(){$.info("SC, drift ready"),window.drift.api.app({event:"register",name:"site-concierge",selector:i.id}),ie(),z.driftReady()}):$.info("drift not loaded")},750)},ie=function ce(){var e=document.getElementById("drift-frame-controller"),t=document.getElementById("drift-frame-chat"),n=document.getElementById("drift-frame-slider");e&&e.classList.add("drift-frame-controller__sc-loaded"),t&&(window.drift.config(re.CHAT),t.classList.add("drift-frame-chat__sc-loaded")),n&&window.drift.config(re.SLIDER)}}}]);